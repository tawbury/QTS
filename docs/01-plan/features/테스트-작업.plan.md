# Plan: 테스트 작업

> PDCA Phase: **Plan**
> Feature: 테스트 작업
> Created: 2026-02-11
> Status: Draft

---

## 1. 개요 (Overview)

QTS 프로젝트의 테스트 작업에 대한 계획 문서.
현재 테스트 인프라 현황을 파악하고, 체계적인 테스트 전략을 수립한다.

## 2. 목표 (Objectives)

- [ ] QTS 테스트 체계의 현재 상태 파악
- [ ] 테스트 커버리지 목표 설정
- [ ] 단위 테스트 / 통합 테스트 / E2E 테스트 범위 정의
- [ ] CI/CD 파이프라인 내 테스트 자동화 전략

## 3. 범위 (Scope)

### In Scope
- 기존 `tests/` 디렉토리의 테스트 현황 분석
- 엔진별 테스트 커버리지 확인 (Strategy, Risk, Portfolio, Trading, Performance)
- Contract 테스트 검증
- Safety Layer 테스트 검증

### Out of Scope
- 실제 브로커 API 연동 테스트 (모킹 처리)
- 프로덕션 환경 부하 테스트

## 4. 요구사항 (Requirements)

### 기능 요구사항 (FR)
| ID | 요구사항 | 우선순위 |
|----|---------|---------|
| FR-01 | 테스트 현황 분석 및 보고서 생성 | High |
| FR-02 | 누락된 테스트 케이스 식별 | High |
| FR-03 | 테스트 자동화 파이프라인 점검 | Medium |
| FR-04 | 테스트 커버리지 기준 설정 | Medium |

### 비기능 요구사항 (NFR)
| ID | 요구사항 | 기준 |
|----|---------|-----|
| NFR-01 | 테스트 실행 시간 | 전체 테스트 5분 이내 |
| NFR-02 | 커버리지 목표 | 80% 이상 |

## 5. 기술 스택 (Tech Stack)

- **Testing**: pytest, pytest-asyncio, pytest-cov
- **Mocking**: unittest.mock, pytest-mock
- **CI**: GitHub Actions
- **Docker**: docker-compose.test.yml

## 6. 우선순위 및 일정 (Priority & Timeline)

| Phase | 작업 | 우선순위 |
|-------|-----|---------|
| 1 | 현황 분석 (테스트 파일 목록, 커버리지) | P0 |
| 2 | 누락 테스트 식별 및 분류 | P0 |
| 3 | 핵심 엔진 테스트 보강 | P1 |
| 4 | CI/CD 파이프라인 테스트 통합 | P2 |

## 7. 리스크 (Risks)

| Risk | Impact | Mitigation |
|------|--------|------------|
| 브로커 API 의존성 | 테스트 불안정 | Mock/Stub 패턴 활용 |
| Google Sheets API 의존성 | 테스트 속도 저하 | NoopSheetsClient 활용 |
| 비동기 코드 테스트 복잡성 | 테스트 작성 어려움 | pytest-asyncio 패턴 표준화 |

## 8. 성공 기준 (Success Criteria)

- [ ] 전체 테스트 통과율 100%
- [ ] 코드 커버리지 80% 이상
- [ ] 핵심 엔진 (Strategy, Risk, Safety) 테스트 커버리지 90% 이상
- [ ] CI에서 자동 테스트 실행 가능

---

> **Next**: `/pdca design 테스트-작업` 으로 Design 문서를 작성합니다.
